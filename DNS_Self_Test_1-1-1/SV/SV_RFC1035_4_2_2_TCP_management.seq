#!/usr/bin/perl
#
# Copyright (C) 2006 Yokogawa Electric Corporation.
# All rights reserved.
# 
# Redistribution and use of this software in source and binary
# forms, with or without modification, are permitted provided that
# the following conditions and disclaimer are agreed and accepted
# by the user:
# 
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in
#    the documentation and/or other materials provided with
#    the distribution.
# 
# 3. Neither the names of the copyrighters, the name of the project
#    which is related to this software (hereinafter referred to as
#    "project") nor the names of the contributors may be used to
#    endorse or promote products derived from this software without
#    specific prior written permission.
# 
# 4. No merchantable use may be permitted without prior written
#    notification to the copyrighters.
# 
# 5. The copyrighters, the project and the contributors may prohibit
#    the use of this software at any time.
# 
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHTERS, THE PROJECT AND
# CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING
# BUT NOT LIMITED THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
# FOR A PARTICULAR PURPOSE, ARE DISCLAIMED.  IN NO EVENT SHALL THE
# COPYRIGHTERS, THE PROJECT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
# INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
# SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
# HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
# STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
# IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
# POSSIBILITY OF SUCH DAMAGE.
#
# $TAHI: ct-dns/dns/SV/SV_RFC1035_4_2_2_TCP_management.seq,v 1.1.1.1 2006/06/02 05:15:45 akisada Exp $
# $Id: SV_RFC1035_4_2_2_TCP_management.seq,v 1.1.1.1 2006/06/02 05:15:45 akisada Exp $
#
######################################################################

BEGIN {
        $kCommon::TestVersion = '$Name: REL_1_1_1 $';
        push( @INC, '/usr/local/koi/libdata' );
        push( @INC, '..' );
}

END {
}

# use strict;
use DNS;

#------------------------------#
# NUT configuration            #
#------------------------------#
my $NutConfig={ 
##mode
	              'ModeRequiredTestMode' => 'recursive',
	              'ModeSetNamedConf' => 'yes',
	              'ModeSetZoneFiles' => 'yes',
	              'ConfOptRecursion' => 'yes',
	              'ConfZone0Name' => 'example.com',
	              'ConfZone0Type' => 'master',
	              'ConfZone0AllowQuery' => 'any',
	              'ConfZone0AllowTransfer' => 'any',
##zone
#SOA
	              'ZoneZone0Name' => 'example.com',
	              'ZoneZone0Ttl' => 86400,
               'ZoneZone0Type' => 'master',
	              'ZoneZone0Rec0Name' => 'example.com.',
	              'ZoneZone0Rec0Type' => 'SOA',
	              'ZoneZone0Rec0Class' => 'IN',
	              'ZoneZone0Rec0Ttl' => 86400,
	              'ZoneZone0Rec0Mname' => 'NS1.example.com.',
	              'ZoneZone0Rec0Rname' => 'root.example.com.',
	              'ZoneZone0Rec0Serial' => 2005081600,
	              'ZoneZone0Rec0Refresh' => 3600,
	              'ZoneZone0Rec0Retry' => 900,
	              'ZoneZone0Rec0Expire' => 604800,
	              'ZoneZone0Rec0Minimum' => 3600,
#@ NS
	              'ZoneZone0Rec1Name' => 'example.com.',
	              'ZoneZone0Rec1Type' => 'NS',
	              'ZoneZone0Rec1Class' => 'IN',
	              'ZoneZone0Rec1Ttl' => 86400,
	              'ZoneZone0Rec1Value' => 'NS1.example.com.',
#NS1 A
	              'ZoneZone0Rec2Name' => 'NS1',
	              'ZoneZone0Rec2Type' => 'A',
	              'ZoneZone0Rec2Class' => 'IN',
	              'ZoneZone0Rec2Ttl' => 86400,
	              'ZoneZone0Rec2Value' => '192.168.0.10',
#A A
	              'ZoneZone0Rec3Name' => 'A',
	              'ZoneZone0Rec3Type' => 'A',
	              'ZoneZone0Rec3Class' => 'IN',
	              'ZoneZone0Rec3Ttl' => 86400,
	              'ZoneZone0Rec3Value' => '192.168.0.11',
	             };

my $remoteRet = DNSRemote("setconfig.rmt",$NutConfig);
unless ( defined($remoteRet) ) {
        Debug_Print("ERROR:DNSRemote\n");
        DNSExit($FAIL);
}

#------------------------------#
# configuration                #
#------------------------------#
my @dns_session_config = ();
my $dns_param          = { 'dns_session_config' => \@dns_session_config };

$dns_session_config[0] = {
        'TN_INTERFACE'   => 'Link0',
        'TN_ADDR'        => $TN_NET0_NODE2_ADDR,
        'TN_ADDR_PORT'   => $TN_CL_PORT,
        'TN_ADDR_PROTO'  => 'UDP',
        'TN_ADDR_FAMILY' => $ADDR_FAMILY,
        'NUT_ADDR'       => $NUT_ADDR_0,
        'NUT_ADDR_PORT'  => $NUT_SV_PORT,
};

$dns_session_config[1] = {
        'TN_INTERFACE'   => 'Link0',
        'TN_ADDR'        => $TN_NET1_NODE2_ADDR,
        'TN_ADDR_PORT'   => $TN_SV_PORT,
        'TN_ADDR_PROTO'  => 'UDP',
        'TN_ADDR_FAMILY' => $ADDR_FAMILY,
        'NUT_ADDR'       => $NUT_ADDR_0,
        'NUT_ADDR_PORT'  => $NUT_CL_PORT,
};

$dns_session_config[2] = {
        'TN_INTERFACE'   => 'Link0',
        'TN_ADDR'        => $TN_NET1_NODE3_ADDR,
        'TN_ADDR_PORT'   => $TN_SV_PORT,
        'TN_ADDR_PROTO'  => 'UDP',
        'TN_ADDR_FAMILY' => $ADDR_FAMILY,
        'NUT_ADDR'       => $NUT_ADDR_0,
        'NUT_ADDR_PORT'  => $NUT_CL_PORT,
};

$dns_session_config[3] = {
        'TN_INTERFACE'   => 'Link0',
        'TN_ADDR'        => $TN_NET1_NODE4_ADDR,
        'TN_ADDR_PORT'   => $TN_SV_PORT,
        'TN_ADDR_PROTO'  => 'UDP',
        'TN_ADDR_FAMILY' => $ADDR_FAMILY,
        'NUT_ADDR'       => $NUT_ADDR_0,
        'NUT_ADDR_PORT'  => $NUT_CL_PORT,
};

$dns_session_config[6] = {
        'TN_INTERFACE'   => 'Link0',
        'TN_ADDR'        => $TN_NET1_NODE4_ADDR,
        'TN_ADDR_PORT'   => $TN_SV_PORT,
        'TN_ADDR_PROTO'  => 'UDP',
        'TN_ADDR_FAMILY' => $ADDR_FAMILY,
        'NUT_ADDR'       => $NUT_ADDR_0,
        'NUT_ADDR_PORT'  => $NUT_CL_PORT,
};

$dns_session_config[4] = {
        'TN_INTERFACE'   => 'Link0',
        'TN_ADDR'        => $TN_NET0_NODE2_ADDR,
        'TN_ADDR_PORT'   => $TN_CL_PORT,
        'TN_ADDR_PROTO'  => 'TCP',
        'TN_ADDR_FAMILY' => $ADDR_FAMILY,
        'NUT_ADDR'       => $NUT_ADDR_0,
        'NUT_ADDR_PORT'  => $NUT_SV_PORT,
};

$dns_session_config[5] = {
        'TN_INTERFACE'   => 'Link0',
        'TN_ADDR'        => $TN_NET1_NODE4_ADDR,
        'TN_ADDR_PORT'   => $TN_SV_PORT,
        'TN_ADDR_PROTO'  => 'TCP',
        'TN_ADDR_FAMILY' => $ADDR_FAMILY,
        'NUT_ADDR'       => $NUT_ADDR_0,
        'NUT_ADDR_PORT'  => $NUT_CL_PORT,
};

$dns_session_config[7] = {
        'TN_INTERFACE'   => 'Link0',
        'TN_ADDR'        => $TN_NET1_NODE4_ADDR,
        'TN_ADDR_PORT'   => $TN_SV_PORT,
        'TN_ADDR_PROTO'  => 'TCP',
        'TN_ADDR_FAMILY' => $ADDR_FAMILY,
        'NUT_ADDR'       => $NUT_ADDR_0,
        'NUT_ADDR_PORT'  => $NUT_CL_PORT,
};

#--------------------
# DNS Server1
#--------------------
my @dns_session   = ();
my @gen_dns_msg_0 = ();
my @exp_dns_msg_0 = ();
my @gen_dns_msg_1 = ();
my @exp_dns_msg_1 = ();
my @gen_dns_msg_2 = ();
my @exp_dns_msg_2 = ();
my @gen_dns_msg_3 = ();
my @exp_dns_msg_3 = ();
my @gen_dns_msg_4 = ();
my @exp_dns_msg_4 = ();
my @gen_dns_msg_5 = ();
my @exp_dns_msg_5 = ();
my @gen_dns_msg_6 = ();
my @exp_dns_msg_6 = ();
my @gen_dns_msg_7 = ();
my @exp_dns_msg_7 = ();
my @gen_dns_msg_8 = ();
my @exp_dns_msg_8 = ();

$dns_session[0] = {
        'socket_ref'      => undef,
        'dns_one_session' => [
                {
                        'gen_dns_msg' => \@gen_dns_msg_0,
                        'dec_dns_msg' => undef,
                        'exp_dns_msg' => \@exp_dns_msg_0
                }
        ]
};
$dns_session[1] = {
        'socket_ref'      => undef,
        'dns_one_session' => [
                {
                        'gen_dns_msg' => \@gen_dns_msg_1,
                        'dec_dns_msg' => undef,
                        'exp_dns_msg' => \@exp_dns_msg_1
                }
        ]
};
$dns_session[2] = {
        'socket_ref'      => undef,
        'dns_one_session' => [
                {
                        'gen_dns_msg' => \@gen_dns_msg_2,
                        'dec_dns_msg' => undef,
                        'exp_dns_msg' => \@exp_dns_msg_2
                }
        ]
};
$dns_session[3] = {
        'socket_ref'      => undef,
        'dns_one_session' => [
                {
                        'gen_dns_msg' => \@gen_dns_msg_3,
                        'dec_dns_msg' => undef,
                        'exp_dns_msg' => \@exp_dns_msg_3
                },
        ]
};

$dns_session[6] = {
        'socket_ref'      => undef,
        'dns_one_session' => [
                {
                        'gen_dns_msg' => \@gen_dns_msg_6,
                        'dec_dns_msg' => undef,
                        'exp_dns_msg' => \@exp_dns_msg_6
                },
        ]
};

$dns_session[4] = {
        'socket_ref'      => undef,
        'dns_one_session' => [
                {
                        'gen_dns_msg' => \@gen_dns_msg_4,
                        'dec_dns_msg' => undef,
                        'exp_dns_msg' => \@exp_dns_msg_4,
                },
                {
                        'gen_dns_msg' => \@gen_dns_msg_7,
                        'dec_dns_msg' => undef,
                        'exp_dns_msg' => \@exp_dns_msg_7,
                },
        ]
};

$dns_session[5] = {
        'socket_ref'      => undef,
        'dns_one_session' => [
                {
                        'gen_dns_msg' => \@gen_dns_msg_5,
                        'dec_dns_msg' => undef,
                        'exp_dns_msg' => \@exp_dns_msg_5
                },
        ]
};

$dns_session[7] = {
        'socket_ref'      => undef,
        'dns_one_session' => [
                {
                        'gen_dns_msg' => \@gen_dns_msg_8,
                        'dec_dns_msg' => undef,
                        'exp_dns_msg' => \@exp_dns_msg_8
                },
        ]
};

#--------------------------
# Send packet definition
#--------------------------
#------------------
# 1st message()
#------------------
#------------------
# Client1(TN) -> NUT
#------------------
$gen_dns_msg_0[0]->{'header'} = {
        'id'      => 0x1000,
        'qr'      => 0,
        'opcode'  => 0,
        'aa'      => 0,
        'tc'      => 0,
        'rd'      => 1,
        'ra'      => 0,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 0,
        'arcount' => 0,
};

$gen_dns_msg_0[0]->{'question'}->[0] = {
        'qname'  => Gen_DNS_Name('A.example.org'),
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

#------------------
# 3rd message()
#------------------
#------------------
# NS2(TN) -> NUT
#------------------
$gen_dns_msg_1[0]->{'header'} = {    # 3rd packet header
        'id'      => undef,
        'qr'      => 1,
        'opcode'  => 0,
        'aa'      => 0,
        'tc'      => 0,
        'rd'      => undef,
        'ra'      => 0,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 1,
        'arcount' => 1,
};

$gen_dns_msg_1[0]->{'question'}->[0] = {    # 3rd packet question
        'qname'  => Gen_DNS_Name('A.example.org'),
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

$gen_dns_msg_1[0]->{'authority'}->[0] = {    # 3rd packet
        'name'     => Gen_DNS_Name( '', 0xC016 ),
        'type'     => 0x0002,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 6,
        'rdata'    => Gen_DNS_Name( 'NS3', 0xC00E ),
};

$gen_dns_msg_1[0]->{'additional'}->[0] = {    # 3rd packet
        'name'     => Gen_DNS_Name( '', 0xC02B ),
        'type'     => $ADDR_TYPE,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => $ADDR_LENGTH,
        'rdata'    => Gen_DNS_RDATA_A($TN_NET1_NODE3_ADDR),
};

#------------------
# 5th message()
#------------------
#------------------
# NS3(TN) -> NUT
#------------------
$gen_dns_msg_2[0]->{'header'} = {    # 5th packet header
        'id'      => undef,
        'qr'      => 1,
        'opcode'  => 0,
        'aa'      => 0,
        'tc'      => 0,
        'rd'      => undef,
        'ra'      => 0,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,

        #	'ancount' => 1,
        'ancount' => 0,
        'nscount' => 1,
        'arcount' => 1,
};

$gen_dns_msg_2[0]->{'question'}->[0] = {    # 5th packet question
        'qname'  => Gen_DNS_Name('A.example.org'),
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

$gen_dns_msg_2[0]->{'authority'}->[0] = {    # 5th packet authority
        'name'     => Gen_DNS_Name( '',    0xC00E ),
        'type'     => 0x0002,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 6,
        'rdata'    => Gen_DNS_Name( 'NS4', 0xC00E ),
};

$gen_dns_msg_2[0]->{'additional'}->[0] = {    # 5th packet additional
        'name'     => Gen_DNS_Name( '', 0xC02B ),
        'type'     => $ADDR_TYPE,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => $ADDR_LENGTH,
        'rdata'    => Gen_DNS_RDATA_A($TN_NET1_NODE4_ADDR),
};

#------------------
# 7th message()
#------------------
#------------------
# NS4(TN) -> NUT
#------------------
$gen_dns_msg_3[0]->{'header'} = {    # 7th packet header
        'id'      => undef,
        'qr'      => 1,
        'opcode'  => 0,
        'aa'      => 1,
        'tc'      => 1,
        'rd'      => 0,
        'ra'      => 1,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 30,

        #	'nscount' => 1,
        #	'arcount' => 1,
        'nscount' => 0,
        'arcount' => 0,
};

$gen_dns_msg_3[0]->{'question'}->[0] = {    # 7th packet question
        'qname'  => Gen_DNS_Name('A.example.org'),
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

$gen_dns_msg_3[0]->{'answer'}->[0] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.100'),
};

$gen_dns_msg_3[0]->{'answer'}->[1] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.101'),
};

$gen_dns_msg_3[0]->{'answer'}->[2] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.102'),
};

$gen_dns_msg_3[0]->{'answer'}->[3] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.103'),
};

$gen_dns_msg_3[0]->{'answer'}->[4] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.104'),
};

$gen_dns_msg_3[0]->{'answer'}->[5] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.105'),
};

$gen_dns_msg_3[0]->{'answer'}->[6] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.106'),
};

$gen_dns_msg_3[0]->{'answer'}->[7] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.107'),
};

$gen_dns_msg_3[0]->{'answer'}->[8] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.108'),
};

$gen_dns_msg_3[0]->{'answer'}->[9] = {      # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.109'),
};

$gen_dns_msg_3[0]->{'answer'}->[10] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.110'),
};

$gen_dns_msg_3[0]->{'answer'}->[11] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.111'),
};

$gen_dns_msg_3[0]->{'answer'}->[12] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.112'),
};

$gen_dns_msg_3[0]->{'answer'}->[13] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.113'),
};

$gen_dns_msg_3[0]->{'answer'}->[14] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.114'),
};

$gen_dns_msg_3[0]->{'answer'}->[15] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.115'),
};

$gen_dns_msg_3[0]->{'answer'}->[16] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.116'),
};

$gen_dns_msg_3[0]->{'answer'}->[17] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.117'),
};

$gen_dns_msg_3[0]->{'answer'}->[18] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.118'),
};

$gen_dns_msg_3[0]->{'answer'}->[19] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.119'),
};

$gen_dns_msg_3[0]->{'answer'}->[20] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.120'),
};

$gen_dns_msg_3[0]->{'answer'}->[21] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.121'),
};

$gen_dns_msg_3[0]->{'answer'}->[22] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.122'),
};

$gen_dns_msg_3[0]->{'answer'}->[23] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.123'),
};

$gen_dns_msg_3[0]->{'answer'}->[24] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.124'),
};

$gen_dns_msg_3[0]->{'answer'}->[25] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.125'),
};

$gen_dns_msg_3[0]->{'answer'}->[26] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.126'),
};

$gen_dns_msg_3[0]->{'answer'}->[27] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.127'),
};

$gen_dns_msg_3[0]->{'answer'}->[28] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.128'),
};

$gen_dns_msg_3[0]->{'answer'}->[29] = {     # 7th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.129'),
};

#------------------
# 9th message()
#------------------
$gen_dns_msg_4[0]->{'header'} = {
        'id'      => 0x1001,
        'qr'      => 0,
        'opcode'  => 0,
        'aa'      => 0,
        'tc'      => 0,
        'rd'      => 1,
        'ra'      => 0,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 0,
        'arcount' => 0,
};

$gen_dns_msg_4[0]->{'question'}->[0] = {
        'qname'  => Gen_DNS_Name('A.example.com'),
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

#------------------
# 11th message()
#------------------
$gen_dns_msg_7[0]->{'header'} = {
        'id'      => 0x1002,
        'qr'      => 0,
        'opcode'  => 0,
        'aa'      => 0,
        'tc'      => 0,
        'rd'      => 1,
        'ra'      => 0,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 0,
        'arcount' => 0,
};

$gen_dns_msg_7[0]->{'question'}->[0] = {
        'qname'  => Gen_DNS_Name('B.example.org'),
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

#------------------
# 13th message()
#------------------
#------------------
# NS4(TN) -> NUT
#------------------
$gen_dns_msg_6[0]->{'header'} = {    # 13th packet header
        'id'      => undef,
        'qr'      => 1,
        'opcode'  => 0,
        'aa'      => 1,
        'tc'      => 1,
        'rd'      => 0,
        'ra'      => 1,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 30,

        #	'nscount' => 1,
        #	'arcount' => 1,
        'nscount' => 0,
        'arcount' => 0,
};

$gen_dns_msg_6[0]->{'question'}->[0] = {    # 13th packet question
        'qname'  => Gen_DNS_Name('B.example.org'),
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

$gen_dns_msg_6[0]->{'answer'}->[0] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.200'),
};

$gen_dns_msg_6[0]->{'answer'}->[1] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.201'),
};

$gen_dns_msg_6[0]->{'answer'}->[2] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.202'),
};

$gen_dns_msg_6[0]->{'answer'}->[3] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.203'),
};

$gen_dns_msg_6[0]->{'answer'}->[4] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.204'),
};

$gen_dns_msg_6[0]->{'answer'}->[5] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.205'),
};

$gen_dns_msg_6[0]->{'answer'}->[6] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.206'),
};

$gen_dns_msg_6[0]->{'answer'}->[7] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.207'),
};

$gen_dns_msg_6[0]->{'answer'}->[8] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.208'),
};

$gen_dns_msg_6[0]->{'answer'}->[9] = {      # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.209'),
};

$gen_dns_msg_6[0]->{'answer'}->[10] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.210'),
};

$gen_dns_msg_6[0]->{'answer'}->[11] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.211'),
};

$gen_dns_msg_6[0]->{'answer'}->[12] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.212'),
};

$gen_dns_msg_6[0]->{'answer'}->[13] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.213'),
};

$gen_dns_msg_6[0]->{'answer'}->[14] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.214'),
};

$gen_dns_msg_6[0]->{'answer'}->[15] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.215'),
};

$gen_dns_msg_6[0]->{'answer'}->[16] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.216'),
};

$gen_dns_msg_6[0]->{'answer'}->[17] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.217'),
};

$gen_dns_msg_6[0]->{'answer'}->[18] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.218'),
};

$gen_dns_msg_6[0]->{'answer'}->[19] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.219'),
};

$gen_dns_msg_6[0]->{'answer'}->[20] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.220'),
};

$gen_dns_msg_6[0]->{'answer'}->[21] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.221'),
};

$gen_dns_msg_6[0]->{'answer'}->[22] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.222'),
};

$gen_dns_msg_6[0]->{'answer'}->[23] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.223'),
};

$gen_dns_msg_6[0]->{'answer'}->[24] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.224'),
};

$gen_dns_msg_6[0]->{'answer'}->[25] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.225'),
};

$gen_dns_msg_6[0]->{'answer'}->[26] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.226'),
};

$gen_dns_msg_6[0]->{'answer'}->[27] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.227'),
};

$gen_dns_msg_6[0]->{'answer'}->[28] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.228'),
};

$gen_dns_msg_6[0]->{'answer'}->[29] = {     # 13th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.229'),
};

#------------------
# 15th message
#------------------
#------------------
# NS4(TN) -> NUT
#------------------
$gen_dns_msg_8[0]->{'header'} = {    # 15th packet header
        'id'      => undef,
        'qr'      => 1,
        'opcode'  => 0,
        'aa'      => 1,
        'tc'      => 0,
        'rd'      => undef,
        'ra'      => 1,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 31,
        'nscount' => 1,
        'arcount' => 1,
};

$gen_dns_msg_8[0]->{'question'}->[0] = {    # 15th packet question
        'qname'  => Gen_DNS_Name('B.example.org'),
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

$gen_dns_msg_8[0]->{'answer'}->[0] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.200'),
};

$gen_dns_msg_8[0]->{'answer'}->[1] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.201'),
};

$gen_dns_msg_8[0]->{'answer'}->[2] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.202'),
};

$gen_dns_msg_8[0]->{'answer'}->[3] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.203'),
};

$gen_dns_msg_8[0]->{'answer'}->[4] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.204'),
};

$gen_dns_msg_8[0]->{'answer'}->[5] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.205'),
};

$gen_dns_msg_8[0]->{'answer'}->[6] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.206'),
};

$gen_dns_msg_8[0]->{'answer'}->[7] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.207'),
};

$gen_dns_msg_8[0]->{'answer'}->[8] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.208'),
};

$gen_dns_msg_8[0]->{'answer'}->[9] = {      # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.0.209'),
};

$gen_dns_msg_8[0]->{'answer'}->[10] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.210'),
};

$gen_dns_msg_8[0]->{'answer'}->[11] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.211'),
};

$gen_dns_msg_8[0]->{'answer'}->[12] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.212'),
};

$gen_dns_msg_8[0]->{'answer'}->[13] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.213'),
};

$gen_dns_msg_8[0]->{'answer'}->[14] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.214'),
};

$gen_dns_msg_8[0]->{'answer'}->[15] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.215'),
};

$gen_dns_msg_8[0]->{'answer'}->[16] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.216'),
};

$gen_dns_msg_8[0]->{'answer'}->[17] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.217'),
};

$gen_dns_msg_8[0]->{'answer'}->[18] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.218'),
};

$gen_dns_msg_8[0]->{'answer'}->[19] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.219'),
};

$gen_dns_msg_8[0]->{'answer'}->[20] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.220'),
};

$gen_dns_msg_8[0]->{'answer'}->[21] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.221'),
};

$gen_dns_msg_8[0]->{'answer'}->[22] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.222'),
};

$gen_dns_msg_8[0]->{'answer'}->[23] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.223'),
};

$gen_dns_msg_8[0]->{'answer'}->[24] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.224'),
};

$gen_dns_msg_8[0]->{'answer'}->[25] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.225'),
};

$gen_dns_msg_8[0]->{'answer'}->[26] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.226'),
};

$gen_dns_msg_8[0]->{'answer'}->[27] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.227'),
};

$gen_dns_msg_8[0]->{'answer'}->[28] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.228'),
};

$gen_dns_msg_8[0]->{'answer'}->[29] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.229'),
};

$gen_dns_msg_8[0]->{'answer'}->[30] = {     # 15th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.230'),
};

$gen_dns_msg_8[0]->{'authority'}->[0] = {    # 15th packet authority
        'name'     => Gen_DNS_Name( '',    0xC00E ),
        'type'     => 0x0002,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 6,
        'rdata'    => Gen_DNS_Name( 'NS4', 0xC00E ),
};

$gen_dns_msg_8[0]->{'additional'}->[0] = {    # 15th packet additional
        'name'     => Gen_DNS_Name( '', 0xC21b ),
        'type'     => $ADDR_TYPE,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => $ADDR_LENGTH,
        'rdata'    => Gen_DNS_RDATA_A($TN_NET1_NODE4_ADDR),
};

#------------------
# 17th message
#------------------
#------------------
# NS4(TN) -> NUT
#------------------
$gen_dns_msg_5[0]->{'header'} = {    # 17th packet header
        'id'      => undef,
        'qr'      => 1,
        'opcode'  => 0,
        'aa'      => 1,
        'tc'      => 0,
        'rd'      => undef,
        'ra'      => 1,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 31,
        'nscount' => 1,
        'arcount' => 1,
};

$gen_dns_msg_5[0]->{'question'}->[0] = {    # 17th packet question
        'qname'  => Gen_DNS_Name('A.example.org'),
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

$gen_dns_msg_5[0]->{'answer'}->[0] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.100'),
};

$gen_dns_msg_5[0]->{'answer'}->[1] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.101'),
};

$gen_dns_msg_5[0]->{'answer'}->[2] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.102'),
};

$gen_dns_msg_5[0]->{'answer'}->[3] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.103'),
};

$gen_dns_msg_5[0]->{'answer'}->[4] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.104'),
};

$gen_dns_msg_5[0]->{'answer'}->[5] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.105'),
};

$gen_dns_msg_5[0]->{'answer'}->[6] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.106'),
};

$gen_dns_msg_5[0]->{'answer'}->[7] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.107'),
};

$gen_dns_msg_5[0]->{'answer'}->[8] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.108'),
};

$gen_dns_msg_5[0]->{'answer'}->[9] = {      # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.109'),
};

$gen_dns_msg_5[0]->{'answer'}->[10] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.110'),
};

$gen_dns_msg_5[0]->{'answer'}->[11] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.111'),
};

$gen_dns_msg_5[0]->{'answer'}->[12] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.112'),
};

$gen_dns_msg_5[0]->{'answer'}->[13] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.113'),
};

$gen_dns_msg_5[0]->{'answer'}->[14] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.114'),
};

$gen_dns_msg_5[0]->{'answer'}->[15] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.115'),
};

$gen_dns_msg_5[0]->{'answer'}->[16] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.116'),
};

$gen_dns_msg_5[0]->{'answer'}->[17] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.117'),
};

$gen_dns_msg_5[0]->{'answer'}->[18] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.118'),
};

$gen_dns_msg_5[0]->{'answer'}->[19] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.119'),
};

$gen_dns_msg_5[0]->{'answer'}->[20] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.120'),
};

$gen_dns_msg_5[0]->{'answer'}->[21] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.121'),
};

$gen_dns_msg_5[0]->{'answer'}->[22] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.122'),
};

$gen_dns_msg_5[0]->{'answer'}->[23] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.123'),
};

$gen_dns_msg_5[0]->{'answer'}->[24] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.124'),
};

$gen_dns_msg_5[0]->{'answer'}->[25] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.125'),
};

$gen_dns_msg_5[0]->{'answer'}->[26] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.126'),
};

$gen_dns_msg_5[0]->{'answer'}->[27] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.127'),
};

$gen_dns_msg_5[0]->{'answer'}->[28] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.128'),
};

$gen_dns_msg_5[0]->{'answer'}->[29] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.129'),
};

$gen_dns_msg_5[0]->{'answer'}->[30] = {     # 17th packet answer
        'name'     => Gen_DNS_Name( '', 0xC00C ),
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => Gen_DNS_RDATA_A('192.168.1.130'),
};

$gen_dns_msg_5[0]->{'authority'}->[0] = {    # 17th packet authority
        'name'     => Gen_DNS_Name( '',    0xC00E ),
        'type'     => 0x0002,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 6,
        'rdata'    => Gen_DNS_Name( 'NS4', 0xC00E ),
};

$gen_dns_msg_5[0]->{'additional'}->[0] = {    # 17th packet additional
        'name'     => Gen_DNS_Name( '', 0xC21b ),
        'type'     => $ADDR_TYPE,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => $ADDR_LENGTH,
        'rdata'    => Gen_DNS_RDATA_A($TN_NET1_NODE4_ADDR),
};

#--------------------------
# Expect packet definition
#--------------------------
#------------------
# 2nd message
#------------------
$exp_dns_msg_1[0]->{'header'} = {
        'id'     => undef,
        'qr'     => 0,
        'opcode' => 0,
        'aa'     => undef,
        'tc'     => 0,
        'rd'      => 0,
        'ra'      => undef,
        'z'       => undef,
        'rcode'   => undef,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 0,
        'arcount' => undef,
};

$exp_dns_msg_1[0]->{'question'}->[0] = {
        'qname'  => 'A.example.org.',
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

#------------------
# 4th message
#------------------
$exp_dns_msg_2[0]->{'header'} = {
        'id' => undef,
        'qr'     => 0,
        'opcode' => 0,
        'aa'     => undef,
        'tc'     => 0,
        'rd'      => 0,
        'ra'      => undef,
        'z'       => undef,
        'rcode'   => undef,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 0,
        'arcount' => undef,
};

$exp_dns_msg_2[0]->{'question'}->[0] = {
        'qname'  => 'A.example.org.',
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

#------------------
# 6th message
#------------------
$exp_dns_msg_3[0]->{'header'} = {
        'id' => undef,
        'qr'     => 0,
        'opcode' => 0,
        'aa'     => undef,
        'tc'     => 0,
        'rd'      => 0,
        'ra'      => undef,
        'z'       => undef,
        'rcode'   => undef,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 0,
        'arcount' => undef,
};

$exp_dns_msg_3[0]->{'question'}->[0] = {
        'qname'  => 'A.example.org.',
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

#------------------
# 8th message
#------------------
$exp_dns_msg_5[0]->{'header'} = {
        'id'      => undef,
        'qr'      => 0,
        'opcode'  => 0,
        'aa'      => undef,
        'tc'      => 0,
        'rd'      => 0,
        'ra'      => undef,
        'z'       => undef,
        'rcode'   => undef,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 0,
        'arcount' => undef,
};

$exp_dns_msg_5[0]->{'question'}->[0] = {
        'qname'  => 'A.example.org.',
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

#------------------
# 10th message
#------------------
$exp_dns_msg_4[0]->{'header'} = {
        'id'      => 0x1001,
        'qr'      => 1,
        'opcode'  => 0,
        'aa'      => 1,
        'tc'      => 0,
        'rd'      => 1,
        'ra'      => 1,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 1,
        'nscount' => 1,
        'arcount' => 1,
};

$exp_dns_msg_4[0]->{'question'}->[0] = {
        'qname'  => 'A.example.com.',
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

$exp_dns_msg_4[0]->{'answer'}->[0] = {
        'name'     => 'A.example.com.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.0.11',
};

$exp_dns_msg_4[0]->{'authority'}->[0] = {
        'name'     => 'example.com.',
        'type'     => 0x0002,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 6,
        'rdata'    => 'NS1.example.com.'
};

$exp_dns_msg_4[0]->{'additional'}->[0] = {
        'name'     => 'NS1.example.com.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.0.10',
};

#------------------
# 12th message
#------------------
$exp_dns_msg_6[0]->{'header'} = {
        'id' => undef,
        'qr'     => 0,
        'opcode' => 0,
        'aa'     => undef,
        'tc'     => 0,
        'rd'      => 0,
        'ra'      => undef,
        'z'       => undef,
        'rcode'   => undef,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 0,
        'arcount' => undef,
};

$exp_dns_msg_6[0]->{'question'}->[0] = {
        'qname'  => 'B.example.org.',
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

#------------------
# 14th message
#------------------
$exp_dns_msg_8[0]->{'header'} = {
        'id'      => undef,
        'qr'      => 0,
        'opcode'  => 0,
        'aa'      => undef,
        'tc'      => 0,
        'rd'      => 0,
        'ra'      => undef,
        'z'       => undef,
        'rcode'   => undef,
        'qdcount' => 1,
        'ancount' => 0,
        'nscount' => 0,
        'arcount' => undef,
};

$exp_dns_msg_8[0]->{'question'}->[0] = {
        'qname'  => 'B.example.org.',
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

#------------------
# 16th message
#------------------
$exp_dns_msg_7[0]->{'header'} = {
        'id'      => 0x1002,
        'qr'      => 1,
        'opcode'  => 0,
        'aa'      => undef,
        'tc'      => 0,
        'rd'      => 1,
        'ra'      => 1,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 31,
        'nscount' => 1,
        'arcount' => undef,
};

$exp_dns_msg_7[0]->{'question'}->[0] = {
        'qname'  => 'B.example.org.',
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

$exp_dns_msg_7[0]->{'answer'}->[0] = {
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.200',
};

$exp_dns_msg_7[0]->{'answer'}->[1] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.201',
};

$exp_dns_msg_7[0]->{'answer'}->[2] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.202',
};

$exp_dns_msg_7[0]->{'answer'}->[3] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.203',
};

$exp_dns_msg_7[0]->{'answer'}->[4] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.204',
};

$exp_dns_msg_7[0]->{'answer'}->[5] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.205',
};

$exp_dns_msg_7[0]->{'answer'}->[6] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.206',
};

$exp_dns_msg_7[0]->{'answer'}->[7] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.207',
};

$exp_dns_msg_7[0]->{'answer'}->[8] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.208',
};

$exp_dns_msg_7[0]->{'answer'}->[9] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.0.209',
};

$exp_dns_msg_7[0]->{'answer'}->[10] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.210',
};

$exp_dns_msg_7[0]->{'answer'}->[11] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.211',
};

$exp_dns_msg_7[0]->{'answer'}->[12] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.212',
};

$exp_dns_msg_7[0]->{'answer'}->[13] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.213',
};

$exp_dns_msg_7[0]->{'answer'}->[14] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.214',
};

$exp_dns_msg_7[0]->{'answer'}->[15] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.215',
};

$exp_dns_msg_7[0]->{'answer'}->[16] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.216',
};

$exp_dns_msg_7[0]->{'answer'}->[17] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.217',
};

$exp_dns_msg_7[0]->{'answer'}->[18] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.218',
};

$exp_dns_msg_7[0]->{'answer'}->[19] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.219',
};

$exp_dns_msg_7[0]->{'answer'}->[20] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.220',
};

$exp_dns_msg_7[0]->{'answer'}->[21] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.221',
};

$exp_dns_msg_7[0]->{'answer'}->[22] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.222',
};

$exp_dns_msg_7[0]->{'answer'}->[23] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.223',
};

$exp_dns_msg_7[0]->{'answer'}->[24] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.224',
};

$exp_dns_msg_7[0]->{'answer'}->[25] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.225',
};

$exp_dns_msg_7[0]->{'answer'}->[26] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.226',
};

$exp_dns_msg_7[0]->{'answer'}->[27] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.227',
};

$exp_dns_msg_7[0]->{'answer'}->[28] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.228',
};

$exp_dns_msg_7[0]->{'answer'}->[29] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.229',
};

$exp_dns_msg_7[0]->{'answer'}->[30] = {    # 16th packet answer
        'name'     => 'B.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 4,
        'rdata'    => '192.168.1.230',
};

$exp_dns_msg_7[0]->{'authority'}->[0] = {
        'name'     => 'example.org.',
        'type'     => 0x0002,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => 6,
        'rdata'    => 'NS4.example.org.'
};

$exp_dns_msg_7[0]->{'additional'}->[0] = {
        'name'     => 'NS4.example.org.',
        'type'     => $ADDR_TYPE,
        'class'    => 0x0001,
        'ttl'      => undef,
        'rdlength' => $ADDR_LENGTH,
        'rdata'    => $TN_NET1_NODE4_ADDR,
};

#------------------
# 18th message
#------------------
$exp_dns_msg_0[0]->{'header'} = {
        'id'      => 0x1000,
        'qr'      => 1,
        'opcode'  => 0,
        'aa'      => undef,
        'tc'      => 1,
        'rd'      => 1,
        'ra'      => 1,
        'z'       => 0,
        'rcode'   => 0,
        'qdcount' => 1,
        'ancount' => 30,
        'nscount' => 0,

        #	'arcount' => 0,
        'arcount' => undef,
};

$exp_dns_msg_0[0]->{'question'}->[0] = {
        'qname'  => 'A.example.org.',
        'qtype'  => 0x0001,
        'qclass' => 0x0001,
};

$exp_dns_msg_0[0]->{'answer'}->[0] = {
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.100',
};

$exp_dns_msg_0[0]->{'answer'}->[1] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.101',
};

$exp_dns_msg_0[0]->{'answer'}->[2] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.102',
};

$exp_dns_msg_0[0]->{'answer'}->[3] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.103',
};

$exp_dns_msg_0[0]->{'answer'}->[4] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.104',
};

$exp_dns_msg_0[0]->{'answer'}->[5] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.105',
};

$exp_dns_msg_0[0]->{'answer'}->[6] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.106',
};

$exp_dns_msg_0[0]->{'answer'}->[7] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.107',
};

$exp_dns_msg_0[0]->{'answer'}->[8] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.108',
};

$exp_dns_msg_0[0]->{'answer'}->[9] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.109',
};

$exp_dns_msg_0[0]->{'answer'}->[10] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.110',
};

$exp_dns_msg_0[0]->{'answer'}->[11] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.111',
};

$exp_dns_msg_0[0]->{'answer'}->[12] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.112',
};

$exp_dns_msg_0[0]->{'answer'}->[13] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.113',
};

$exp_dns_msg_0[0]->{'answer'}->[14] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.114',
};

$exp_dns_msg_0[0]->{'answer'}->[15] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.115',
};

$exp_dns_msg_0[0]->{'answer'}->[16] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.116',
};

$exp_dns_msg_0[0]->{'answer'}->[17] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.117',
};

$exp_dns_msg_0[0]->{'answer'}->[18] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.118',
};

$exp_dns_msg_0[0]->{'answer'}->[19] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.119',
};

$exp_dns_msg_0[0]->{'answer'}->[20] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.120',
};

$exp_dns_msg_0[0]->{'answer'}->[21] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.121',
};

$exp_dns_msg_0[0]->{'answer'}->[22] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.122',
};

$exp_dns_msg_0[0]->{'answer'}->[23] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.123',
};

$exp_dns_msg_0[0]->{'answer'}->[24] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.124',
};

$exp_dns_msg_0[0]->{'answer'}->[25] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.125',
};

$exp_dns_msg_0[0]->{'answer'}->[26] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.126',
};

$exp_dns_msg_0[0]->{'answer'}->[27] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.127',
};

$exp_dns_msg_0[0]->{'answer'}->[28] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.128',
};

$exp_dns_msg_0[0]->{'answer'}->[29] = {    # 18th packet answer
        'name'     => 'A.example.org.',
        'type'     => 0x0001,
        'class'    => 0x0001,
        'ttl'      => 86400,
        'rdlength' => 4,
        'rdata'    => '192.168.1.129',
};

# $exp_dns_msg_0[0]->{'authority'}->[0] =
# {
# 	'name'   => 'example.org.',
# 	'type'   => 0x0002,
# 	'class'  => 0x0001,
# 	'ttl'    => 86400,
# 	'rdlength' => 6,
# 	'rdata'  => 'NS4.example.org.'
# };

# $exp_dns_msg_0[0]->{'additional'}->[0] =
# {
# 	'name'   => 'NS4.example.org.',
# 	'type'     => $ADDR_TYPE,
# 	'class'  => 0x0001,
# 	'ttl'    => 86400,
# 	'rdlength' => $ADDR_LENGTH,
# 	'rdata'  => $TN_NET1_NODE4_ADDR,
# };

################################
# start tests                  #
################################

my $ret = DNSStartConnect( $dns_param, \@dns_session );
unless ( defined($ret) ) {
        Debug_Print("ERROR:DNSStartConnect\n");
        DNSExit($FAIL);
}

#------------------------------#
# 1st packet (send)            #
#------------------------------#
$ret = undef;
$ret = DNSSend(
        1,
        $dns_session[0]->{'socket_ref'},
        $dns_session[0]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't send DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Send 1st message\n"] );

#------------------------------#
# 2nd packet (receive@NS2)     #
#------------------------------#
$ret = undef;
$ret = DNSRecv(
        1, 60,
        $dns_session[1]->{'socket_ref'},
        $dns_session[1]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't receive DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Receive 2nd message\n"] );

#------------------------------#
# Judgment (2nd packet)        #
#------------------------------#
Print_Message(
        "#",
        [
                "Judgment (2nd packet)\n",
"2. Received standard query including QNAME=A.example.org, QTYPE=A.\n",
        ]
);

my $recv_data = $dns_session[1]->{'dns_one_session'}->[0]->{'dec_dns_msg'}->[0];

$ret = undef;
$ret = JudgeDNSMsg( $recv_data, $exp_dns_msg_1[0] );

unless ( defined($ret) ) {
        DNSExit($FAIL);
}

Print_Message( "=", ["2nd packet PASS\n"] );

#------------------------------#
# 3rd packet (send From NS2)   #
#------------------------------#
#-------------------------------
# Copy Header RD and ID from NUT query
#-------------------------------
$gen_dns_msg_1[0]->{'header'}->{'id'} = $recv_data->{'header'}->{'id'};
$gen_dns_msg_1[0]->{'header'}->{'rd'} = $recv_data->{'header'}->{'rd'};

$ret = undef;
$ret = DNSSend(
        1,
        $dns_session[1]->{'socket_ref'},
        $dns_session[1]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't send DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Send 3rd message\n"] );

#------------------------------#
# 4th packet (receive@NS3)     #
#------------------------------#
$ret = undef;
$ret = DNSRecv(
        1, 60,
        $dns_session[2]->{'socket_ref'},
        $dns_session[2]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't receive DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Receive 4th message\n"] );

#------------------------------#
# Judgment (4th packet)        #
#------------------------------#
Print_Message(
        "#",
        [
                "Judgment (4th packet)\n",
"4. Received standard query including QNAME=A.example.org, QTYPE=A.\n",
        ]
);

$recv_data = undef;
$recv_data = $dns_session[2]->{'dns_one_session'}->[0]->{'dec_dns_msg'}->[0];

$ret = undef;
$ret = JudgeDNSMsg( $recv_data, $exp_dns_msg_2[0] );

unless ( defined($ret) ) {
        DNSExit($FAIL);
}
Print_Message( "=", ["4th packet PASS\n"] );

#------------------------------#
# 5th packet (send from NS3)   #
#------------------------------#
#-------------------------------
# Copy Header RD and ID from NUT query
#-------------------------------
$gen_dns_msg_2[0]->{'header'}->{'id'} = $recv_data->{'header'}->{'id'};
$gen_dns_msg_2[0]->{'header'}->{'rd'} = $recv_data->{'header'}->{'rd'};

$ret = undef;
$ret = DNSSend(
        1,
        $dns_session[2]->{'socket_ref'},
        $dns_session[2]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't send DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Send 5th message\n"] );

#------------------------------#
# 6th packet (receive@NS4)     #
#------------------------------#
$ret = undef;
$ret = DNSRecv(
        1, 60,
        $dns_session[3]->{'socket_ref'},
        $dns_session[3]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't receive DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Receive 6th message\n"] );

#------------------------------#
# Judgment (6th packet)        #
#------------------------------#
Print_Message(
        "#",
        [
                "Judgment (6th packet)\n",
"6. Received standard query including QNAME=A.example.org, QTYPE=A.\n",
        ]
);

$recv_data = undef;
$recv_data = $dns_session[3]->{'dns_one_session'}->[0]->{'dec_dns_msg'}->[0];

$ret = undef;
$ret = JudgeDNSMsg( $recv_data, $exp_dns_msg_3[0] );

unless ( defined($ret) ) {
        DNSExit($FAIL);
}

Print_Message( "=", ["6th packet PASS\n"] );

#------------------------------#
# 7th packet (send from NS4)   #
#------------------------------#
#-------------------------------
# Copy Header RD and ID from NUT query
#-------------------------------
$gen_dns_msg_3[0]->{'header'}->{'id'} = $recv_data->{'header'}->{'id'};
$gen_dns_msg_3[0]->{'header'}->{'rd'} = $recv_data->{'header'}->{'rd'};

$ret = undef;
$ret = DNSSend(
        1,
        $dns_session[3]->{'socket_ref'},
        $dns_session[3]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't send DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Send 7th message\n"] );

#------------------------------#
# 8th packet (receive@NS4)     #
#------------------------------#
$ret = undef;
$ret = DNSRecv(
        1, 5,
        $dns_session[5]->{'socket_ref'},
        $dns_session[5]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't receive DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Receive 8th message\n"] );

#------------------------------#
# Judgment (8th packet)        #
#------------------------------#
Print_Message(
        "#",
        [
                "Judgment (8th packet)\n",
"8. Received standard query including QNAME=A.example.org in TCP.\n",
        ]
);
$recv_data = undef;
$recv_data = $dns_session[5]->{'dns_one_session'}->[0]->{'dec_dns_msg'}->[0];

$ret = undef;
$ret = JudgeDNSMsg( $recv_data, $exp_dns_msg_5[0] );

unless ( defined($ret) ) {
        DNSExit($FAIL);
}

Print_Message( "=", ["8th packet PASS\n"] );

#-------------------------------
# SAVE Header RD and ID
#-------------------------------
my $saved_id = $recv_data->{'header'}->{'id'};
my $saved_rd = $recv_data->{'header'}->{'rd'};

#------------------------------#
# 9th packet (send)            #
#------------------------------#
$ret = undef;
$ret = DNSSend(
        1,
        $dns_session[4]->{'socket_ref'},
        $dns_session[4]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't send DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Send 9th message\n"] );

#------------------------------#
# 10th packet (receive@Client) #
#------------------------------#
$ret = undef;
$ret = DNSRecv(
        1, 5,
        $dns_session[4]->{'socket_ref'},
        $dns_session[4]->{'dns_one_session'}->[0]
);
unless ( defined($ret) ) {
        DNSExit($FAIL);
}
#Print_Message( "=", ["Receive 10th message\n"] );

#------------------------------#
# Judgment (10th packet)       #
#------------------------------#
Print_Message(
        "#",
        [
                "Judgment (10th packet)\n",
"10. Received standard query response for QNAME=A.example.com QTYPE=A in TCP.\n",
        ]
);
$recv_data = undef;
$recv_data = $dns_session[4]->{'dns_one_session'}->[0]->{'dec_dns_msg'}->[0];

$ret = undef;
$ret = JudgeDNSMsg( $recv_data, $exp_dns_msg_4[0] );

unless ( defined($ret) ) {
        DNSExit($FAIL);
}
Print_Message( "=", ["10th packet PASS\n"] );

#------------------------------#
# 11th packet (send)           #
#------------------------------#
$ret = undef;
$ret = DNSSend(
        1,
        $dns_session[4]->{'socket_ref'},
        $dns_session[4]->{'dns_one_session'}->[1]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't send DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Send 11th message\n"] );

#------------------------------#
# 12th packet (receive@NS4)    #
#------------------------------#
$ret = undef;
$ret = DNSRecv(
        1, 5,
        $dns_session[6]->{'socket_ref'},
        $dns_session[6]->{'dns_one_session'}->[0]
);
unless ( defined($ret) ) {
        DNSExit($FAIL);
}
#Print_Message( "=", ["Receive 12th message\n"] );

#------------------------------#
# Judgment (12th packet)       #
#------------------------------#
Print_Message(
        "#",
        [
                "Judgment (12th packet)\n",
"12. Received standard query including QNAME=B.example.org, QTYPE=A.\n",
        ]
);
$recv_data = undef;
$recv_data = $dns_session[6]->{'dns_one_session'}->[0]->{'dec_dns_msg'}->[0];

$ret = undef;
$ret = JudgeDNSMsg( $recv_data, $exp_dns_msg_6[0] );

unless ( defined($ret) ) {
        DNSExit($FAIL);
}
Print_Message( "=", ["12th packet PASS\n"] );

#------------------------------#
# 13th packet (send From NS4)  #
#------------------------------#
#-------------------------------
# Copy Header RD and ID from NUT query
#-------------------------------
$gen_dns_msg_6[0]->{'header'}->{'id'} = $recv_data->{'header'}->{'id'};
$gen_dns_msg_6[0]->{'header'}->{'rd'} = $recv_data->{'header'}->{'rd'};

$ret = undef;
$ret = DNSSend(
        1,
        $dns_session[6]->{'socket_ref'},
        $dns_session[6]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't send DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Send 13th message\n"] );

#------------------------------#
# 14th packet (receive@NS4)    #
#------------------------------#
$ret = undef;
$ret = DNSRecv(
        1, 5,
        $dns_session[7]->{'socket_ref'},
        $dns_session[7]->{'dns_one_session'}->[0]
);
unless ( defined($ret) ) {
        DNSExit($FAIL);
}
#Print_Message( "=", ["Receive 14th message\n"] );

#------------------------------#
# Judgment (14th packet)       #
#------------------------------#
Print_Message(
        "#",
        [
                "Judgment (14th packet)\n",
"14. Received standard query including QNAME=B.example.org, QTYPE=A in TCP.\n",
        ]
);
$recv_data = undef;
$recv_data = $dns_session[7]->{'dns_one_session'}->[0]->{'dec_dns_msg'}->[0];

$ret = undef;
$ret = JudgeDNSMsg( $recv_data, $exp_dns_msg_8[0] );

unless ( defined($ret) ) {
        DNSExit($FAIL);
}
Print_Message( "=", ["14th packet PASS\n"] );

#------------------------------#
# 15th packet (send From NS4)  #
#------------------------------#
#-------------------------------
# Copy Header RD and ID from NUT query
#-------------------------------
$gen_dns_msg_8[0]->{'header'}->{'id'} = $recv_data->{'header'}->{'id'};
$gen_dns_msg_8[0]->{'header'}->{'rd'} = $recv_data->{'header'}->{'rd'};

$ret = undef;
$ret = DNSSend(
        1,
        $dns_session[7]->{'socket_ref'},
        $dns_session[7]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't send DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Send 15th message\n"] );

#------------------------------#
# 16th packet (receive@Client) #
#------------------------------#
$ret = undef;
$ret = DNSRecv(
        1, 5,
        $dns_session[4]->{'socket_ref'},
        $dns_session[4]->{'dns_one_session'}->[1]
);
unless ( defined($ret) ) {
        DNSExit($FAIL);
}
#Print_Message( "=", ["Receive 16th message\n"] );

#------------------------------#
# Judgment (16th packet)       #
#------------------------------#
Print_Message(
        "#",
        [
                "Judgment (16th packet)\n",
"16. Received standard query response for QNAME=B.example.org QTYPE=A in TCP.\n",
        ]
);
$recv_data = undef;
$recv_data = $dns_session[4]->{'dns_one_session'}->[1]->{'dec_dns_msg'}->[0];

$ret = undef;
$ret = JudgeDNSMsg( $recv_data, $exp_dns_msg_7[0] );

unless ( defined($ret) ) {
        DNSExit($FAIL);
}
Print_Message( "=", ["16th packet PASS\n"] );

#------------------------------#
# 17th packet (send)           #
#------------------------------#
#-------------------------------
# Copy Header RD and ID from NUT query
#-------------------------------
$gen_dns_msg_5[0]->{'header'}->{'id'} = $saved_id;
$gen_dns_msg_5[0]->{'header'}->{'rd'} = $saved_rd;
$ret                                  = undef;
$ret                                  = DNSSend(
        1,
        $dns_session[5]->{'socket_ref'},
        $dns_session[5]->{'dns_one_session'}->[0]
);
unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't send DNS message\n");
        DNSExit($FAIL);
}

#Print_Message( "=", ["Send 17th message\n"] );

#------------------------------#
# 18th packet (receive@CLIENT)  #
#------------------------------#
$ret = undef;
$ret = DNSRecv(
        1, 60,
        $dns_session[0]->{'socket_ref'},
        $dns_session[0]->{'dns_one_session'}->[0]
);

unless ( defined($ret) ) {
        Debug_Print("ERROR: Can't receive DNS message\n");
        DNSExit($FAIL);
}
#Print_Message( "=", ["Receive 18th message\n"] );

#------------------------------#
# Judgment (18th packet)       #
#------------------------------#
Print_Message(
        "#",
        [
                "Judgment (18th packet)\n",
"18. Received standard query response for QNAME=A.example.org QTYPE=A (TC bit is set).\n",
        ]
);
$recv_data = undef;
$recv_data = $dns_session[0]->{'dns_one_session'}->[0]->{'dec_dns_msg'}->[0];

$ret = undef;
$ret = JudgeDNSMsg( $recv_data, $exp_dns_msg_0[0] );

unless ( defined($ret) ) {
        DNSExit($FAIL);
}

Print_Message( "=", ["18th packet PASS\n"] );

DNSExit($OK);
__END__

######################################################################

=head1 NAME

	SV_RFC1035_4_2_2_TCP_management - TCP connection management check

=head1 VERIFICATION POINTS

	Verify that a NUT supports multiple TCP connections.

=begin html
	<UL>
	<li>The server should not block other activities waiting for TCP data.
	</li>
	<li>The server should support multiple connections.
	</li>
	</ul> 

=end html

=head1 TARGET

	Caching Server

=head1 SYNOPSIS

=begin html
<PRE>
	<A HREF="./SV_RFC1035_4_2_2_TCP_management.seq">SV_RFC1035_4_2_2_TCP_management.seq</A> [-tooloption ...]: KOI tool option
	See also <A HREF="../DNSConfig.pm">DNSConfig.pm</A>
</PRE>

=end html

=head1 INITIALIZATION

=begin html
	<UL>
	<DD><LI><STRONG>Network Topology</STRONG></LI> 
	<PRE>
                                 . domain                 org domain               example.org domain
        AP Server1 (TN)          DNS Server2              DNS Server3              DNS Server4
          |A.example.org           |A.ROOT.NET              |NS3.example.org         |NS4.example.org
          |3ffe:501:ffff:101::100  |3ffe:501:ffff:101::20   |3ffe:501:ffff:101::30   |3ffe:501:ffff:101::40 
          |192.168.1.100           |192.168.1.20            |192.168.1.30            |192.168.1.40
          |                        |                        |                        |
Net-y   --+--------+---------------+------------+-----------+------------------------+-- 3ffe:501:ffff:101::/64
                   |                            |                                        192.168.1/24
                   |                            |
                   |                            |
                 Router (TN)                  AP Server2 (TN)
                   |3ffe:501:ffff:100::1         B.example.org
                   |192.168.0.1                  3ffe:501:ffff:101::200
                   |                             192.168.0.200
                   |
                   |
Net-z   --+--------+-----------------+--------------------------+------- 3ffe:501:ffff:100::/64
          |                          |                          |        192.168.0/24
          |                          |                          |
        DNS Server1 (NUT)          DNS Client1 (TN)            AP Server2 (TN)
           3ffe:501:ffff:100::XXXX    3ffe:501:ffff:100::20      A.example.com
           192.168.0.10               192.168.0.20               3ffe:501:ffff:100::11 
                                                                 192.168.0.11
	<BR>
	XXXX: EUI64
	</PRE>
	<DD><LI><STRONG>Setup</STRONG></LI><BR>
	<BR>
	<DD>Set the DNS Server1's (NUT) address as above mentioned Network Topology.<BR>
	<DD>Configure the Server1's (NUT) zone file to response query from TN.<BR>
	<BR>
	<DD>Example of root server list:</BR>
	<BR>
	<DD>&nbsp;&nbsp;For IPv4:
	<PRE>
.                       3600000         IN      NS      A.ROOT.NET.
A.ROOT.NET.             3600000                 A       192.168.1.20
	</PRE>
	<DD>&nbsp;&nbsp;For IPv6:
	<PRE>
.                       3600000         IN      NS      A.ROOT.NET.
A.ROOT.NET.             3600000                 AAAA    3ffe:501:ffff:101::20
	</PRE>
	<DD>Example of example.com zone file:<BR>
	<PRE>
$TTL    86400           ; TTL of 1 day
@ IN SOA NS1.example.com. root.example.com. (
	2005081600	; serial
	3600		; refresh every 1 hr
	900		; retry every 15 min
	604800		; expire after a week
	3600		; Minimum TTL of a 1 hr
)
;
	IN	NS	NS1.example.com.
NS1	IN	A	192.168.0.10
;
A	IN	A	192.168.0.11
	</PRE>
	</UL>

=end html

=head1 TEST PROCEDURE

	This test sequence is following.

                                                                    <-------------- TN --------------->

    DNS Client1 (TN)             DNS Server1 (NUT)                  DNS Server2 DNS Server3 DNS Server4
	|                              |                                 |           |           |
	|----------------------------->|                                 |           |           |
	| 1. Send standard query       |                                 |           |           |
	|  QNAME=A.example.org         |                                 |           |           |
	|  QTYPE=A                     |                                 |           |           |
	|                              |                                 |           |           |
	|                              |-------------------------------->|           |           |
	|                              | 2. Recv standard query          |           |           |
	|                              |  QNAME=A.example.org            |           |           |
	|                              |  QTYPE=A                        |           |           |
	|                              |                                 |           |           |
	|                              |<--------------------------------|           |           |
	|                              | 3. Send standard query response |           |           |
	|                              |  QNAME=A.example.org            |           |           |
	|                              |  QTYPE=A                        |           |           |
	|                              |  AUTHORITY Name=org             |           |           |
	|                              |  AUTHORITY Name Server          |           |           |
	|                              |            =NS3.example.org     |           |           |
	|                              |  ADDITIONAL Name                |           |           |
	|                              |            =NS3.example.org     |           |           |
	|                              |  ADDITIONAL Address             |           |           |
	|                              |            =192.168.1.30        |           |           |
	|                              |                                 |           |           |
	|                              |                                 v           |           |
	|                              |                                             |           |
	|                              |-------------------------------------------->|           |
	|                              |             4. Recv standard query          |           |
	|                              |              QNAME=A.example.org            |           |
	|                              |              QTYPE=A                        |           |
	|                              |                                             |           |
	|                              |<--------------------------------------------|           |
	|                              |             5. Send standard query response |           |
	|                              |              QNAME=A.example.org            |           |
	|                              |              QTYPE=A                        |           |
	|                              |              AUTHORITY Name=example.org     |           |
	|                              |              AUTHORITY Name Server          |           |
	|                              |                     = NS4.example.org       |           |
	|                              |              ADDITIONAL Name                |           |
	|                              |                     = NS4.example.org       |           |
	|                              |              ADDITIONAL Address             |           |
	|                              |                     = 192.168.1.40          |           |
	|                              |                                             |           |
	|                              |                                             v           |
	|                              |                                                         |
	|                              |-------------------------------------------------------->|
	|                              |                          6. Send standard query         |
	|                              |                           QNAME=A.example.org           |
	|                              |                           QTYPE=A                       |
	|                              |                                                         |
	|                              |<--------------------------------------------------------|
	|                              |                          7. Send standard query response|
	|                              |                           TC bit is set                 |
	|                              |                           QNAME=A.example.org           |
	|                              |                           QTYPE=A                       |
	|                              |                           ANSWER Name=A.example.org     |
	|                              |                           ANSWER Address=192.168.1.100  |
	|                              |                                        to               |
	|                              |                                          192.168.1.129  |
	|                              |                                                         |
	|                              |-------------------------------------------------------->|
	|                              |                          8. Send standard query in TCP  |
	|                              |                           QNAME=A.example.org           |
	|                              |                           QTYPE=A                       |
	|                              |                                                         |
	|----------------------------->|                                                         |
	| 9. Send standard query in TCP|                                                         |
	|  QNAME=A.example.com         |                                                         |
	|  QTYPE=A                     |                                                         |
	|                              |                                                         |
	|<-----------------------------|                                                         |
	| 10. Standard query response  |                                                         |
	|     in TCP                   |                                                         |
	|  QNAME= A.example.com        |                                                         |
	|  QTYPE=A                     |                                                         |
	|  ANSWER Name=A.example.com   |                                                         |
	|  ANSWER Address=192.168.0.11 |                                                         |
	|                              |                                                         |
	|----------------------------->|                                                         |
	|11. Send standard query in TCP|                                                         |
	|  QNAME=B.example.org         |                                                         |
	|  QTYPE=A                     |                                                         |
	|                              |                                                         |
	|                              |-------------------------------------------------------->|
	|                              |                          12. Send standard query        |
	|                              |                           QNAME=B.example.org           |
	|                              |                           QTYPE=A                       |
	|                              |                                                         |
	|                              |<--------------------------------------------------------|
	|                              |                         13. Send standard query response|
	|                              |                           TC bit is set                 |
	|                              |                           QNAME=B.example.org           |
	|                              |                           QTYPE=A                       |
	|                              |                           ANSWER Name=A.example.org     |
	|                              |                           ANSWER Address=192.168.0.200  |
	|                              |                                        to               |
	|                              |                                          192.168.1.229  |
	|                              |                                                         |
	|                              |-------------------------------------------------------->|
	|                              |                         14. Send standard query in TCP  |
	|                              |                           QNAME=B.example.org           |
	|                              |                           QTYPE=A                       |
	|                              |                                                         |
	|                              |<--------------------------------------------------------|
	|                              |                         15. Send standard query response|
	|                              |                             in TCP                      |
	|                              |                           QNAME=B.example.org           |
	|                              |                           QTYPE=A                       |
	|                              |                           ANSWER Name=A.example.org     |
	|                              |                           ANSWER Address=192.168.0.200  |
	|                              |                                        to               |
	|                              |                                          192.168.1.230  |
	|                              |                                                         |
	|<-----------------------------|                                                         |
	| 16. Standard query response  |                                                         |
	|     in TCP                   |                                                         |
	|  QNAME= A.example.org        |                                                         |
	|  QTYPE=A                     |                                                         |
	|  ANSWER Name=A.example.org   |                                                         |
	|  ANSWER Address=192.168.0.200|                                                         |
	|               to             |                                                         |
	|                 192.168.1.230|                                                         |
	|                              |                                                         |
	|                              |<--------------------------------------------------------|
	|                              |                         17. Send standard query response|
	|                              |                             in TCP                      |
	|                              |                           QNAME=A.example.org           |
	|                              |                           QTYPE=A                       |
	|                              |                           ANSWER Name=A.example.org     |
	|                              |                           ANSWER Address=192.168.1.100  |
	|                              |                                        to               |
	|                              |                                          192.168.1.130  |
	|                              |                                                         |
	|                              |                                                         |
	|<-----------------------------|                                                         |
	| 18. Standard query response  |                                                         |
	|  TC bit is set               |                                                         |
	|  QNAME= A.example.org        |                                                         |
	|  QTYPE=A                     |                                                         |
	|  ANSWER Name=A.example.org   |                                                         |
	|  ANSWER Address=192.168.1.100|                                                         |
	|               to             |                                                         |
	|                 192.168.1.129|                                                         |
	|                              |                                                         |
	v                              v                                                         v

	1. TN send standard query QNAME=A.example.org, QTYPE=A to NUT.
        2. NUT transmits standard query to DNS Server2 (TN: root name server) (Judgment *2)
        3. TN send query response to NUT w/ AUTHORITY Name=org, AUTHORITY Name Server=NS3.example.org.
        4. NUT transmits standard query QNAME=A.example.org, QTYPE=A to DNS Server3 (TN: NS3.example.org) (Judgment *4)
        5. TN send query response to NUT w/ AUTHORITY Name=example.org, AUTHORITY Name Server=NS4.example.org.
        6. NUT transmits standard query QNAME=A.example.org, QTYPE=A to DNS Server4 (TN: NS4.example.org) (Judgment *6)
        7. TN send query response to ANSWER Name=A.example.org, ANSWER Address=192.168.1.100 - 192.168.1.129 to NUT.
        8. NUT transmits standard query QNAME=A.example.org, QTYPE=A to DNS Server4 (TN: NS4.example.org) in TCP (Judgment *8)
	9. TN send standard query QNAME=A.example.com, QTYPE=A to NUT in TCP.
        10. NUT transmits query response to DNS Client1 (TN) in TCP (Judgment *10)
	11. TN send standard query QNAME=B.example.org, QTYPE=A to NUT in TCP.
        12. NUT transmits standard query QNAME=B.example.org, QTYPE=A to DNS Server4 (TN: NS4.example.org) (Judgment *12)
        13. TN send query response to ANSWER Name=B.example.org, ANSWER Address=192.168.0.200 - 192.168.1.229 to NUT.
	14. TN send standard query QNAME=B.example.com, QTYPE=A to NUT in TCP. (Judgment *14)
        15. TN send query response to ANSWER Name=B.example.org, ANSWER Address=192.168.0.200 - 192.168.1.230 to NUT in TCP.
        16. NUT transmits query response to DNS Client1 (TN) (Judgment *16)
        17. TN send query response to ANSWER Name=A.example.org, ANSWER Address=192.168.1.100 - 192.168.1.130 to NUT in TCP.
        18. NUT transmits query response to DNS Client1 (TN) (Judgment *18)

=begin html
	<UL>
	<DD><LI>Packet Description</LI><BR>
	<BR>
	<DD>1st packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query from DNS Client1 (TN) to Server1 (NUT) </CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>CL1_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>2000</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>0x1000</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>A.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>2nd packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query from DNS Server1 (NUT) to Server2 (TN)</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>SV2_NETY</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>A.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>3rd packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query response from DNS Server2 (TN) to Server1 (NUT) </CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>SV2_NETY</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>
			A.example.org
			</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Authority section</TD>
			<TD>NAME</TD>
			<TD>org (Pointer 0xC016)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>NS (0x0002)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>6</TD>
		</TR>
		<TR>
			<TD>NSDNAME</TD>
			<TD>NS3.example.org (NS3 + Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Additional section</TD>
			<TD>NAME</TD>
			<TD>NS3.example.org (Pointer 0xC02B)</TD>
		</TR>
		<TR>
			<TD>TYPE<BR>
			</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.30</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>4th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query from DNS Server1 (NUT) to Server3 (TN)</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>SV3_NETY</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>A.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>5th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query response from DNS Server3 (TN) to Server1 (NUT) </CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>SV3_NETY</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>
			A.example.org
			</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Authority section</TD>
			<TD>NAME</TD>
			<TD>example.org (Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>NS (0x0002)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>6</TD>
		</TR>
		<TR>
			<TD>NSDNAME</TD>
			<TD>NS4.example.org (NS4 + Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Additional section</TD>
			<TD>NAME</TD>
			<TD>NS4.example.org (Pointer 0xC02B)</TD>
		</TR>
		<TR>
			<TD>TYPE<BR>
			</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.40</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>6th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query from DNS Server1 (NUT) to Server4 (TN)</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>SV4_NETY</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>A.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>7th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query response from DNS Server4 (TN) to Server1 (NUT) </CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>SV4_NETY</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>30</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>
			A.example.org
			</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)
			</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.100</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section<BR> x 28<BR>ADDRESS range 192.168.1.101 - 192.168.1.128</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>****</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.129</TD>
		</TR>
<!--
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Authority section</TD>
			<TD>NAME</TD>
			<TD>example.org (Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>NS (0x0002)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>6</TD>
		</TR>
		<TR>
			<TD>NSDNAME</TD>
			<TD>NS4.example.org (NS4 + Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Additional section</TD>
			<TD>NAME</TD>
			<TD>NS4.example.org (Pointer 0xC03B)</TD>
		</TR>
		<TR>
			<TD>TYPE<BR>
			</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.40</TD>
		</TR>
-->
		</TBODY>
	</TABLE>
	<BR>
	<DD>8th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query from DNS Server1 (NUT) to Server4 (TN) in TCP</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>SV4_NETY</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">TCP Header</TD>
			<TD>Src Port</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>A.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>9th  packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query from DNS Client1 (TN) to Server1 (NUT) in TCP</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>CL1_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>2000</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>0x1001</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>A.example.com</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>10 packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query response from DNS Server1 (NUT) to Client1 (TN) in TCP</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>CL1_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>2000</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>0x1001</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>A.example.com</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>A.example.com (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.0.11</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Authority section</TD>
			<TD>NAME</TD>
			<TD>example.com (Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>NS (0x0002)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>6</TD>
		</TR>
		<TR>
			<TD>NSDNAME</TD>
			<TD>NS1.example.com (NS1 + Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Additional section</TD>
			<TD>NAME</TD>
			<TD>NS1.example.com (Pointer 0xC03B)</TD>
		</TR>
		<TR>
			<TD>TYPE<BR>
			</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.0.10</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>11th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query from DNS Client1 (TN) to Server1 (NUT) in TCP</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>CL1_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>2000</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>0x1002</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>B.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>12th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query from DNS Server1 (NUT) to Server4 (TN)</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>SV4_NETY</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>B.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>13th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query response from DNS Server4 (TN) to Server1 (NUT) </CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>SV4_NETY</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>30</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>
			B.example.org
			</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)
			</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.0.200</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section<BR> x 28<BR>ADDRESS range 192.168.0.201 - 192.168.1.228</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>****</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.229</TD>
		</TR>
<!--
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Authority section</TD>
			<TD>NAME</TD>
			<TD>example.org (Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>NS (0x0002)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>6</TD>
		</TR>
		<TR>
			<TD>NSDNAME</TD>
			<TD>NS4.example.org (NS4 + Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Additional section</TD>
			<TD>NAME</TD>
			<TD>NS4.example.org (Pointer 0xC03B)</TD>
		</TR>
		<TR>
			<TD>TYPE<BR>
			</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.40</TD>
		</TR>
-->
		</TBODY>
	</TABLE>
	<BR>
	<DD>14th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query from DNS Server1 (NUT) to Server4 (TN) in TCP</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>SV4_NETY</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">TCP Header</TD>
			<TD>Src Port</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>any</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>B.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>15th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query response from DNS Server4 (TN) to Server1 (NUT) in TCP </CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>SV4_NETY</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">TCP Header</TD>
			<TD>Src Port</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>31</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>
			B.example.org
			</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>B.example.org (Pointer 0xC00C)
			</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.0.200</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section<BR> x 28<BR>ADDRESS range 192.168.0.201 - 192.168.1.229</TD>
			<TD>NAME</TD>
			<TD>B.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>****</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>B.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.230</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Authority section</TD>
			<TD>NAME</TD>
			<TD>example.org (Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>NS (0x0002)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>6</TD>
		</TR>
		<TR>
			<TD>NSDNAME</TD>
			<TD>NS4.example.org (NS4 + Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Additional section</TD>
			<TD>NAME</TD>
			<TD>NS4.example.org (Pointer 0xC221)</TD>
		</TR>
		<TR>
			<TD>TYPE<BR>
			</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.40</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>16th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query response from DNS Server1 (NUT) to Client1 (TN) in TCP</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>CL1_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>2000</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>0x1002</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>31</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>B.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>B.example.org (Pointer 0xC00C)
			</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.0.200</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section<BR> x 28<BR>ADDRESS range 192.168.0.201 - 192.168.1.229</TD>
			<TD>NAME</TD>
			<TD>B.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>****</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>B.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.230</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Authority section</TD>
			<TD>NAME</TD>
			<TD>example.org (Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>NS (0x0002)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>6</TD>
		</TR>
		<TR>
			<TD>NSDNAME</TD>
			<TD>NS4.example.org (NS4 + Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Additional section</TD>
			<TD>NAME</TD>
			<TD>NS4.example.org (Pointer 0xC221)</TD>
		</TR>
		<TR>
			<TD>TYPE<BR>
			</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.40</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>17th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query response from DNS Server4 (TN) to Server1 (NUT) in TCP </CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>SV4_NETY</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">TCP Header</TD>
			<TD>Src Port</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>Value that NUT uses</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>31</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>
			A.example.org
			</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)
			</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.100</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section<BR> x 28<BR>ADDRESS range 192.168.1.101 - 192.168.1.129</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>****</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.130</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Authority section</TD>
			<TD>NAME</TD>
			<TD>example.org (Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>NS (0x0002)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>6</TD>
		</TR>
		<TR>
			<TD>NSDNAME</TD>
			<TD>NS4.example.org (NS4 + Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Additional section</TD>
			<TD>NAME</TD>
			<TD>NS4.example.org (Pointer 0xC221)</TD>
		</TR>
		<TR>
			<TD>TYPE<BR>
			</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.40</TD>
		</TR>
		</TBODY>
	</TABLE>
	<BR>
	<DD>18th packet.
	<P></P>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD COLSPAN="3">
			<CENTER>Standard query response from DNS Server1 (NUT) to Client1 (TN)</CENTER>
			</TD>
		</TR>
		<TR>
			<TD ROWSPAN="2">IP Header</TD>
			<TD>Source Address</TD>
			<TD>NUT_NETZ</TD>
		</TR>
		<TR>
			<TD>Destination Address</TD>
			<TD>CL1_NETZ</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="2">UDP Header</TD>
			<TD>Src Port</TD>
			<TD>53</TD>
		</TR>
		<TR>
			<TD>Dst Port</TD>
			<TD>2000</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="13">DNS Header</TD>
			<TD>ID</TD>
			<TD>0x1000</TD>
		</TR>
		<TR>
			<TD>QR</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>OPCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>AA</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>TC</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>RD</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>RA</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>Z</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>RCODE</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>QDCOUNT</TD>
			<TD>1</TD>
		</TR>
		<TR>
			<TD>ANCOUNT</TD>
			<TD>30</TD>
		</TR>
		<TR>
			<TD>NSCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD>ARCOUNT</TD>
			<TD>0</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="3">DNS Question section</TD>
			<TD>QNAME</TD>
			<TD>A.example.org</TD>
		</TR>
		<TR>
			<TD>QTYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>QCLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)
			</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.100</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section<BR> x 25<BR>ADDRESS range 192.168.1.101 - 192.168.1.128</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>****</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Answer section</TD>
			<TD>NAME</TD>
			<TD>A.example.org (Pointer 0xC00C)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.129</TD>
		</TR>
<!--
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Authority section</TD>
			<TD>NAME</TD>
			<TD>example.org (Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD>TYPE</TD>
			<TD>NS (0x0002)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>6</TD>
		</TR>
		<TR>
			<TD>NSDNAME</TD>
			<TD>NS4.example.org (NS4 + Pointer 0xC00E)</TD>
		</TR>
		<TR>
			<TD COLSPAN="1" ROWSPAN="6">DNS Additional section</TD>
			<TD>NAME</TD>
			<TD>NS4.example.org (Pointer 0xC03B)</TD>
		</TR>
		<TR>
			<TD>TYPE<BR>
			</TD>
			<TD>A (0x0001)</TD>
		</TR>
		<TR>
			<TD>CLASS</TD>
			<TD>IN (0x0001)</TD>
		</TR>
		<TR>
			<TD>TTL</TD>
			<TD>1 day (86400)</TD>
		</TR>
		<TR>
			<TD>RDLENGTH</TD>
			<TD>4</TD>
		</TR>
		<TR>
			<TD>ADDRESS</TD>
			<TD>192.168.1.40</TD>
		</TR>
-->
		</TBODY>
	</TABLE>
	<BR>
	<BR>
	<DD>Exp.
	<BR>
	<DD><TABLE BORDER="1">
		<TBODY>
		<TR>
			<TD>NUT_NETZ</TD>
			<TD>DNS Server1's (NUT) Net-z address</TD>
		</TR>
		<TR>
			<TD>CL1_NETZ</TD>
			<TD>DNS Client1's (TN) Net-z address</TD>
		</TR>
		<TR>
			<TD>SV2_NETY</TD>
			<TD>DNS Server2's (TN) Net-y address</TD>
		</TR>
		<TR>
			<TD>SV3_NETY</TD>
			<TD>DNS Server3's (TN) Net-y address</TD>
		</TR>
		<TR>
			<TD>SV4_NETY</TD>
			<TD>DNS Server4's (TN) Net-y address</TD>
		</TR>
		</TBODY>
	</TABLE>
	</UL>

=end html

=head1 JUDGMENT

	2. Received standard query including QNAME=A.example.org, QTYPE=A.
	4. Received standard query including QNAME=A.example.org, QTYPE=A.
	6. Received standard query including QNAME=A.example.org, QTYPE=A.
	8. Received standard query including QNAME=A.example.org in TCP.
	10. Received standard query response for QNAME=A.example.com QTYPE=A in TCP.
	12. Received standard query including QNAME=B.example.org, QTYPE=A.
	14. Received standard query including QNAME=B.example.org, QTYPE=A in TCP.
	16. Received standard query response for QNAME=B.example.org QTYPE=A in TCP.
	18. Received standard query response for QNAME=A.example.org QTYPE=A (TC bit is set).

=head1 TERMINATION

	None

=head1 REFERENCE

	RFC1035 DOMAIN NAMES - CONCEPTS AND FACILITIES
	4.2.2. TCP usage

=cut
